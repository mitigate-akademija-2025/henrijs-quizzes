<% if games.any? %>
  <div class="space-y-3">
    <% games.each do |game| %>
      <% total   = game.quiz.questions.size %>
      <% percent = (total.positive? && game.score) ? ((game.score.to_f / total) * 100).round : nil %>

      <div class="group relative overflow-hidden rounded-2xl border border-gray-200/70 bg-white/80 p-4 shadow-sm backdrop-blur supports-[backdrop-filter]:bg-white/60 transition hover:shadow-md">
        <!-- subtle gradient accent -->
        <div class="pointer-events-none absolute inset-x-0 top-0 h-px bg-gradient-to-r from-blue-500/40 via-cyan-500/40 to-violet-500/40"></div>

        <div class="flex items-start justify-between gap-4">
          <!-- Left: title + meta + progress -->
          <div class="min-w-0 flex-1">
            <div class="flex items-center gap-2">
              <span class="inline-flex h-7 w-7 items-center justify-center rounded-lg bg-blue-600/10 text-blue-700 ring-1 ring-inset ring-blue-600/20">
                <!-- quiz icon -->
                <svg class="h-4.5 w-4.5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                  <path d="M8 4h8a2 2 0 0 1 2 2v12l-6-3-6 3V6a2 2 0 0 1 2-2Z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                </svg>
              </span>

              <%= link_to game.quiz.title, game.quiz,
                    class: "truncate text-[15px] font-semibold text-gray-900 hover:text-blue-700" %>
            </div>

            <div class="mt-1 flex flex-wrap items-center gap-x-2 gap-y-1 text-xs text-gray-500">
              <span class="inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 ring-1 ring-inset ring-gray-200">
                by <%= game.quiz.user.username || "User" %>
              </span>
              <span aria-hidden="true">•</span>
              <span class="inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 ring-1 ring-inset ring-gray-200">
                finished <%= time_ago_in_words(game.finished_at) %> ago
              </span>
              <% if percent %>
                <span aria-hidden="true">•</span>
                <span class="inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-emerald-700 ring-1 ring-inset ring-emerald-200">
                  <strong class="mr-1 font-semibold"><%= percent %>%</strong> score
                </span>
              <% end %>
            </div>

            <% if percent %>
              <div class="mt-3">
                <div class="flex items-center justify-between text-xs">
                  <span class="text-gray-500">Progress</span>
                  <span class="font-medium text-gray-700"><%= game.score %>/<%= total %></span>
                </div>
                <div class="mt-1 h-2 w-full overflow-hidden rounded-full bg-gray-100/80 ring-1 ring-inset ring-gray-200/60">
                  <div class="h-full rounded-full bg-gradient-to-r from-emerald-500 to-emerald-400 transition-all duration-300"
                       style="width: <%= percent %>%"></div>
                </div>
              </div>
            <% end %>
          </div>

          <!-- Right: CTA -->
          <div class="flex shrink-0 items-center gap-2">
            <%= link_to game.quiz,
                  class: "inline-flex items-center rounded-xl bg-blue-600 px-3.5 py-2 text-sm font-medium text-white shadow-sm ring-1 ring-blue-600/20 transition hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500/60" do %>
              Open
              <svg class="ml-1.5 h-4 w-4" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M9 5l7 7-7 7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <div class="mt-5">
    <%= paginate games %>
  </div>
<% else %>
  <div class="rounded-2xl border border-dashed border-gray-300 bg-white/70 p-8 text-center shadow-sm">
    <div class="mx-auto mb-2 inline-flex h-10 w-10 items-center justify-center rounded-xl bg-gray-100 ring-1 ring-inset ring-gray-200">
      <svg class="h-5 w-5 text-gray-400" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
      </svg>
    </div>
    <p class="text-sm text-gray-600">No completed games yet.</p>
    <div class="mt-3">
      <%= link_to "Browse quizzes", quizzes_path,
            class: "inline-flex items-center rounded-xl bg-gray-900 px-3.5 py-2 text-sm font-medium text-white hover:bg-black focus:outline-none focus:ring-2 focus:ring-gray-900/30" %>
    </div>
  </div>
<% end %>
